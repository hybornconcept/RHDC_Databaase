<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2200 1700" font-family="'Segoe UI', Arial, sans-serif">

  <!-- ══════════════════════════════════════════════════════════════ -->
  <!-- BACKGROUND                                                     -->
  <!-- ══════════════════════════════════════════════════════════════ -->
  <rect width="2200" height="1700" fill="#0f172a"/>

  <!-- ══════════════════════════════════════════════════════════════ -->
  <!-- TITLE                                                          -->
  <!-- ══════════════════════════════════════════════════════════════ -->
  <text x="1100" y="44" text-anchor="middle" font-size="26" font-weight="bold" fill="#f8fafc">
    Remote Hustle Database Challenge (RHDC) — Entity Relationship Diagram
  </text>
  <text x="1100" y="70" text-anchor="middle" font-size="14" fill="#94a3b8">
    PostgreSQL Master Operational Database | Stage 1 | 10 Tables
  </text>

  <!-- ══════════════════════════════════════════════════════════════ -->
  <!--                                                                -->
  <!--  LAYOUT PLAN (all coordinates are table top-left corners)     -->
  <!--                                                                -->
  <!--  ROW 1  (y=100):                                              -->
  <!--    users          x=60                                         -->
  <!--    stages         x=560                                        -->
  <!--    judges         x=1060                                        -->
  <!--    reports        x=1600                                        -->
  <!--                                                                -->
  <!--  ROW 2  (y=480):                                              -->
  <!--    participants   x=60                                         -->
  <!--    submissions    x=600                                        -->
  <!--    evaluations    x=1150                                        -->
  <!--                                                                -->
  <!--  ROW 3  (y=870):                                              -->
  <!--    stage_progress x=60                                         -->
  <!--    audit_logs     x=600                                        -->
  <!--    notifications  x=1150                                        -->
  <!--                                                                -->
  <!--  LEGEND x=1700, y=480                                         -->
  <!-- ══════════════════════════════════════════════════════════════ -->


  <!-- ══════════════════════════════════════════════════════════════ -->
  <!-- RELATIONSHIP LINES  (drawn before tables so tables sit on top) -->
  <!-- ══════════════════════════════════════════════════════════════ -->

  <!-- 1. users ──1:1── participants  (vertical, left column)
       users bottom-centre: (230, 310)  →  participants top-centre: (230, 480) -->
  <line x1="230" y1="310" x2="230" y2="480" stroke="#3b82f6" stroke-width="2" stroke-dasharray="8,4"/>
  <text x="238" y="402" font-size="11" fill="#60a5fa">1 : 1</text>

  <!-- 2. users ──1:1── judges  (horizontal row 1)
       users right-mid: (430, 195)  →  judges left-mid: (1060, 195) -->
  <line x1="430" y1="195" x2="1060" y2="195" stroke="#3b82f6" stroke-width="2" stroke-dasharray="8,4"/>
  <text x="720" y="187" font-size="11" fill="#60a5fa">1 : 1</text>

  <!-- 3. users ──1:N── notifications
       users left-mid (60, 210) rail down left edge to notifications top (230, 870) -->
  <line x1="60"  y1="210" x2="30"  y2="210" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="6,4"/>
  <line x1="30"  y1="210" x2="30"  y2="910" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="6,4"/>
  <line x1="30"  y1="910" x2="60"  y2="910" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="6,4"/>
  <text x="36" y="570" font-size="11" fill="#60a5fa">1:N</text>

  <!-- 4. users ──1:N── audit_logs
       users top (230, 100) → rail up → across → down to audit_logs (750, 870) -->
  <line x1="230" y1="100" x2="230" y2="82"  stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="6,4"/>
  <line x1="230" y1="82"  x2="800" y2="82"  stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="6,4"/>
  <line x1="800" y1="82"  x2="800" y2="870" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="6,4"/>
  <text x="470" y="79" font-size="11" fill="#60a5fa">1 : N</text>

  <!-- 5. users ──1:N── reports
       users right (430,165) → rail to reports left (1600,165) -->
  <line x1="430"  y1="165" x2="1600" y2="165" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="6,4"/>
  <text x="950"  y="158" font-size="11" fill="#60a5fa">1 : N</text>

  <!-- 6. participants ──1:N── submissions  (horizontal row 2)
       participants right (430, 620)  →  submissions left (600, 620) -->
  <line x1="430" y1="620" x2="600" y2="620" stroke="#10b981" stroke-width="2.5"/>
  <text x="490" y="612" font-size="11" fill="#34d399">1 : N</text>

  <!-- 7. participants ──1:N── stage_progress  (vertical left column)
       participants bottom (230, 760)  →  stage_progress top (230, 870) -->
  <line x1="230" y1="760" x2="230" y2="870" stroke="#10b981" stroke-width="2.5"/>
  <text x="238" y="820" font-size="11" fill="#34d399">1 : N</text>

  <!-- 8. stages ──1:N── submissions
       stages bottom-centre (760, 420)  →  submissions top-centre (830, 480) -->
  <line x1="760" y1="420" x2="760" y2="455" stroke="#f59e0b" stroke-width="2.5"/>
  <line x1="760" y1="455" x2="830" y2="455" stroke="#f59e0b" stroke-width="2.5"/>
  <line x1="830" y1="455" x2="830" y2="480" stroke="#f59e0b" stroke-width="2.5"/>
  <text x="770" y="450" font-size="11" fill="#fbbf24">1 : N</text>

  <!-- 9. stages ──1:N── stage_progress
       stages bottom (700, 420)  →  elbow down to stage_progress top (340, 870) -->
  <line x1="620" y1="420" x2="620" y2="450" stroke="#f59e0b" stroke-width="2"/>
  <line x1="620" y1="450" x2="340" y2="450" stroke="#f59e0b" stroke-width="2"/>
  <line x1="340" y1="450" x2="340" y2="870" stroke="#f59e0b" stroke-width="2"/>
  <text x="430" y="444" font-size="11" fill="#fbbf24">1 : N</text>

  <!-- 10. stages ──1:N── reports  (row 1, horizontal right)
       stages right (960, 250)  →  reports left (1600, 250) -->
  <line x1="960"  y1="250" x2="1600" y2="250" stroke="#f59e0b" stroke-width="2"/>
  <text x="1230" y="243" font-size="11" fill="#fbbf24">1 : N</text>

  <!-- 11. submissions ──1:N── evaluations  (horizontal row 2)
       submissions right (1000, 620)  →  evaluations left (1150, 620) -->
  <line x1="1000" y1="620" x2="1150" y2="620" stroke="#ec4899" stroke-width="2.5"/>
  <text x="1052" y="612" font-size="11" fill="#f472b6">1 : N</text>

  <!-- 12. judges ──1:N── evaluations
       judges bottom (1330, 420)  →  elbow down  →  evaluations top (1430, 480) -->
  <line x1="1330" y1="420" x2="1330" y2="455" stroke="#a78bfa" stroke-width="2"/>
  <line x1="1330" y1="455" x2="1430" y2="455" stroke="#a78bfa" stroke-width="2"/>
  <line x1="1430" y1="455" x2="1430" y2="480" stroke="#a78bfa" stroke-width="2"/>
  <text x="1345" y="450" font-size="11" fill="#c4b5fd">1 : N</text>

  <!-- 13. submissions ──auto trigger──> audit_logs  (vertical, centre)
       submissions bottom (800, 800)  →  audit_logs top (800, 870) -->
  <line x1="800" y1="800" x2="800" y2="870" stroke="#ef4444" stroke-width="1.5" stroke-dasharray="6,4"/>
  <text x="808" y="840" font-size="11" fill="#f87171">auto</text>

  <!-- ══════════════════════════════════════════════════════════════ -->
  <!-- ROW 1 — TABLES                                                 -->
  <!-- ══════════════════════════════════════════════════════════════ -->

  <!-- TABLE: users   x=60 y=100  w=370 h=210 -->
  <g transform="translate(60,100)">
    <rect width="370" height="210" rx="10" fill="#1e293b" stroke="#3b82f6" stroke-width="2.5"/>
    <rect width="370" height="36" rx="10" fill="#2563eb"/>
    <rect y="26" width="370" height="10" fill="#2563eb"/>
    <text x="185" y="24" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">&#x1F464;  users</text>
    <rect x="10" y="44" width="350" height="24" rx="4" fill="#1e3a5f"/>
    <text x="20" y="61" font-size="12" fill="#fbbf24">&#x1F511;  user_id</text>
    <text x="230" y="61" font-size="11" fill="#94a3b8">UUID  PRIMARY KEY</text>
    <line x1="10" y1="70" x2="360" y2="70" stroke="#334155"/>
    <text x="20" y="88"  font-size="12" fill="#e2e8f0">full_name</text>      <text x="220" y="88"  font-size="11" fill="#64748b">VARCHAR(150) NOT NULL</text>
    <text x="20" y="107" font-size="12" fill="#e2e8f0">email</text>           <text x="220" y="107" font-size="11" fill="#64748b">VARCHAR(255) UNIQUE</text>
    <text x="20" y="126" font-size="12" fill="#e2e8f0">password_hash</text>   <text x="220" y="126" font-size="11" fill="#64748b">TEXT NOT NULL</text>
    <text x="20" y="145" font-size="12" fill="#e2e8f0">role</text>            <text x="220" y="145" font-size="11" fill="#64748b">ENUM user_role</text>
    <text x="20" y="164" font-size="12" fill="#e2e8f0">phone</text>           <text x="220" y="164" font-size="11" fill="#64748b">VARCHAR(30)</text>
    <text x="20" y="183" font-size="12" fill="#e2e8f0">country</text>         <text x="220" y="183" font-size="11" fill="#64748b">VARCHAR(100)</text>
    <text x="20" y="202" font-size="12" fill="#e2e8f0">is_active, created_at</text><text x="220" y="202" font-size="11" fill="#64748b">BOOL / TIMESTAMPTZ</text>
  </g>

  <!-- TABLE: stages   x=560 y=100  w=400 h=320 -->
  <g transform="translate(560,100)">
    <rect width="400" height="320" rx="10" fill="#1e293b" stroke="#f59e0b" stroke-width="2.5"/>
    <rect width="400" height="36" rx="10" fill="#d97706"/>
    <rect y="26" width="400" height="10" fill="#d97706"/>
    <text x="200" y="24" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">&#x1F3C1;  stages</text>
    <rect x="10" y="44" width="380" height="24" rx="4" fill="#78350f"/>
    <text x="20" y="61" font-size="12" fill="#fbbf24">&#x1F511;  stage_id</text>     <text x="230" y="61" font-size="11" fill="#94a3b8">SERIAL  PRIMARY KEY</text>
    <line x1="10" y1="70" x2="390" y2="70" stroke="#334155"/>
    <text x="20" y="88"  font-size="12" fill="#e2e8f0">stage_name</text>       <text x="230" y="88"  font-size="11" fill="#64748b">VARCHAR(150) NOT NULL</text>
    <text x="20" y="108" font-size="12" fill="#e2e8f0">stage_number</text>     <text x="230" y="108" font-size="11" fill="#64748b">INTEGER UNIQUE</text>
    <text x="20" y="128" font-size="12" fill="#e2e8f0">description</text>      <text x="230" y="128" font-size="11" fill="#64748b">TEXT</text>
    <text x="20" y="148" font-size="12" fill="#e2e8f0">theme</text>            <text x="230" y="148" font-size="11" fill="#64748b">VARCHAR(255)</text>
    <text x="20" y="168" font-size="12" fill="#e2e8f0">start_date</text>       <text x="230" y="168" font-size="11" fill="#64748b">DATE</text>
    <text x="20" y="188" font-size="12" fill="#e2e8f0">end_date</text>         <text x="230" y="188" font-size="11" fill="#64748b">DATE</text>
    <text x="20" y="208" font-size="12" fill="#e2e8f0">duration_days</text>    <text x="230" y="208" font-size="11" fill="#64748b">INTEGER DEFAULT 7</text>
    <text x="20" y="228" font-size="12" fill="#e2e8f0">status</text>           <text x="230" y="228" font-size="11" fill="#64748b">ENUM stage_status</text>
    <text x="20" y="248" font-size="12" fill="#e2e8f0">max_score</text>        <text x="230" y="248" font-size="11" fill="#64748b">NUMERIC(6,2) DEFAULT 100</text>
    <text x="20" y="268" font-size="12" fill="#e2e8f0">created_at</text>       <text x="230" y="268" font-size="11" fill="#64748b">TIMESTAMPTZ</text>
    <line x1="10" y1="278" x2="390" y2="278" stroke="#334155"/>
    <text x="20" y="296" font-size="11" fill="#f59e0b" font-style="italic">CHECK: end_date &gt;= start_date</text>
    <text x="20" y="312" font-size="11" fill="#f59e0b" font-style="italic">UNIQUE: stage_number</text>
  </g>

  <!-- TABLE: judges   x=1060 y=100  w=390 h=320 -->
  <g transform="translate(1060,100)">
    <rect width="390" height="320" rx="10" fill="#1e293b" stroke="#a78bfa" stroke-width="2.5"/>
    <rect width="390" height="36" rx="10" fill="#7c3aed"/>
    <rect y="26" width="390" height="10" fill="#7c3aed"/>
    <text x="195" y="24" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">&#x2696;  judges</text>
    <rect x="10" y="44" width="370" height="24" rx="4" fill="#3b0764"/>
    <text x="20" y="61" font-size="12" fill="#fbbf24">&#x1F511;  judge_id</text>     <text x="230" y="61" font-size="11" fill="#94a3b8">UUID  PRIMARY KEY</text>
    <rect x="10" y="70" width="370" height="24" rx="4" fill="#4c0891"/>
    <text x="20" y="87" font-size="12" fill="#c4b5fd">&#x1F517;  user_id</text>      <text x="230" y="87" font-size="11" fill="#94a3b8">UUID  FK &rarr; users</text>
    <line x1="10" y1="96" x2="380" y2="96" stroke="#334155"/>
    <text x="20" y="114" font-size="12" fill="#e2e8f0">expertise</text>        <text x="230" y="114" font-size="11" fill="#64748b">VARCHAR(255)</text>
    <text x="20" y="134" font-size="12" fill="#e2e8f0">organization</text>     <text x="230" y="134" font-size="11" fill="#64748b">VARCHAR(200)</text>
    <text x="20" y="154" font-size="12" fill="#e2e8f0">assigned_stages</text>  <text x="230" y="154" font-size="11" fill="#64748b">INTEGER[]  (array)</text>
    <text x="20" y="174" font-size="12" fill="#e2e8f0">is_active</text>        <text x="230" y="174" font-size="11" fill="#64748b">BOOLEAN DEFAULT TRUE</text>
    <text x="20" y="194" font-size="12" fill="#e2e8f0">created_at</text>       <text x="230" y="194" font-size="11" fill="#64748b">TIMESTAMPTZ</text>
    <line x1="10" y1="205" x2="380" y2="205" stroke="#334155"/>
    <text x="20" y="222" font-size="11" fill="#a78bfa" font-style="italic">UNIQUE: user_id</text>
    <text x="20" y="240" font-size="11" fill="#a78bfa" font-style="italic">ROLE: rh_judge  (write evaluations only)</text>
    <text x="20" y="258" font-size="11" fill="#a78bfa" font-style="italic">RLS: judges edit only their own evaluations</text>
  </g>

  <!-- TABLE: reports   x=1600 y=100  w=400 h=310 -->
  <g transform="translate(1600,100)">
    <rect width="400" height="310" rx="10" fill="#1e293b" stroke="#06b6d4" stroke-width="2.5"/>
    <rect width="400" height="36" rx="10" fill="#0891b2"/>
    <rect y="26" width="400" height="10" fill="#0891b2"/>
    <text x="200" y="24" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">&#x1F4CA;  reports</text>
    <rect x="10" y="44" width="380" height="24" rx="4" fill="#164e63"/>
    <text x="20" y="61" font-size="12" fill="#fbbf24">&#x1F511;  report_id</text>    <text x="240" y="61" font-size="11" fill="#94a3b8">UUID  PRIMARY KEY</text>
    <rect x="10" y="70" width="380" height="24" rx="4" fill="#155e75"/>
    <text x="20" y="87" font-size="12" fill="#67e8f9">&#x1F517;  generated_by</text> <text x="240" y="87" font-size="11" fill="#94a3b8">UUID  FK &rarr; users</text>
    <rect x="10" y="96" width="380" height="24" rx="4" fill="#155e75"/>
    <text x="20" y="113" font-size="12" fill="#67e8f9">&#x1F517;  stage_id</text>    <text x="240" y="113" font-size="11" fill="#94a3b8">INTEGER  FK &rarr; stages (nullable)</text>
    <line x1="10" y1="122" x2="390" y2="122" stroke="#334155"/>
    <text x="20" y="140" font-size="12" fill="#e2e8f0">report_name</text>      <text x="240" y="140" font-size="11" fill="#64748b">VARCHAR(255) NOT NULL</text>
    <text x="20" y="160" font-size="12" fill="#e2e8f0">report_type</text>      <text x="240" y="160" font-size="11" fill="#64748b">VARCHAR(100)</text>
    <text x="20" y="180" font-size="12" fill="#e2e8f0">report_data</text>      <text x="240" y="180" font-size="11" fill="#64748b">JSONB  (flexible payload)</text>
    <text x="20" y="200" font-size="12" fill="#e2e8f0">summary</text>          <text x="240" y="200" font-size="11" fill="#64748b">TEXT</text>
    <text x="20" y="220" font-size="12" fill="#e2e8f0">generated_at</text>     <text x="240" y="220" font-size="11" fill="#64748b">TIMESTAMPTZ DEFAULT NOW()</text>
    <line x1="10" y1="230" x2="390" y2="230" stroke="#334155"/>
    <text x="20" y="248" font-size="11" fill="#06b6d4" font-style="italic">Auto-generated via generate_stage_report()</text>
    <text x="20" y="266" font-size="11" fill="#06b6d4" font-style="italic">Stored as JSONB for flexible analytics</text>
    <text x="20" y="284" font-size="11" fill="#06b6d4" font-style="italic">Admin-only write access via rh_admin role</text>
  </g>

  <!-- ══════════════════════════════════════════════════════════════ -->
  <!-- ROW 2 — TABLES                                                 -->
  <!-- ══════════════════════════════════════════════════════════════ -->

  <!-- TABLE: participants   x=60 y=480  w=370 h=280 -->
  <g transform="translate(60,480)">
    <rect width="370" height="280" rx="10" fill="#1e293b" stroke="#10b981" stroke-width="2.5"/>
    <rect width="370" height="36" rx="10" fill="#059669"/>
    <rect y="26" width="370" height="10" fill="#059669"/>
    <text x="185" y="24" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">&#x1F393;  participants</text>
    <rect x="10" y="44" width="350" height="24" rx="4" fill="#064e3b"/>
    <text x="20" y="61" font-size="12" fill="#fbbf24">&#x1F511;  participant_id</text> <text x="230" y="61" font-size="11" fill="#94a3b8">UUID  PRIMARY KEY</text>
    <rect x="10" y="70" width="350" height="24" rx="4" fill="#065f46"/>
    <text x="20" y="87" font-size="12" fill="#6ee7b7">&#x1F517;  user_id</text>       <text x="230" y="87" font-size="11" fill="#94a3b8">UUID  FK &rarr; users</text>
    <line x1="10" y1="96" x2="360" y2="96" stroke="#334155"/>
    <text x="20" y="114" font-size="12" fill="#e2e8f0">registration_no</text>   <text x="230" y="114" font-size="11" fill="#64748b">VARCHAR(30) UNIQUE</text>
    <text x="20" y="134" font-size="12" fill="#e2e8f0">cohort</text>            <text x="230" y="134" font-size="11" fill="#64748b">VARCHAR(50)</text>
    <text x="20" y="154" font-size="12" fill="#e2e8f0">track</text>             <text x="230" y="154" font-size="11" fill="#64748b">VARCHAR(100)</text>
    <text x="20" y="174" font-size="12" fill="#e2e8f0">bio</text>               <text x="230" y="174" font-size="11" fill="#64748b">TEXT</text>
    <text x="20" y="194" font-size="12" fill="#e2e8f0">github_url</text>        <text x="230" y="194" font-size="11" fill="#64748b">VARCHAR(255)</text>
    <text x="20" y="214" font-size="12" fill="#e2e8f0">linkedin_url</text>      <text x="230" y="214" font-size="11" fill="#64748b">VARCHAR(255)</text>
    <text x="20" y="234" font-size="12" fill="#e2e8f0">status</text>            <text x="230" y="234" font-size="11" fill="#64748b">ENUM participant_status</text>
    <text x="20" y="254" font-size="12" fill="#e2e8f0">registered_at</text>     <text x="230" y="254" font-size="11" fill="#64748b">TIMESTAMPTZ</text>
    <text x="20" y="272" font-size="12" fill="#e2e8f0">updated_at</text>        <text x="230" y="272" font-size="11" fill="#64748b">TIMESTAMPTZ  (auto-trigger)</text>
  </g>

  <!-- TABLE: submissions   x=600 y=480  w=400 h=320 -->
  <g transform="translate(600,480)">
    <rect width="400" height="320" rx="10" fill="#1e293b" stroke="#ec4899" stroke-width="2.5"/>
    <rect width="400" height="36" rx="10" fill="#be185d"/>
    <rect y="26" width="400" height="10" fill="#be185d"/>
    <text x="200" y="24" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">&#x1F4CB;  submissions</text>
    <rect x="10" y="44" width="380" height="24" rx="4" fill="#500724"/>
    <text x="20" y="61" font-size="12" fill="#fbbf24">&#x1F511;  submission_id</text> <text x="240" y="61" font-size="11" fill="#94a3b8">UUID  PRIMARY KEY</text>
    <rect x="10" y="70" width="380" height="24" rx="4" fill="#831843"/>
    <text x="20" y="87" font-size="12" fill="#f9a8d4">&#x1F517;  participant_id</text> <text x="240" y="87" font-size="11" fill="#94a3b8">UUID  FK &rarr; participants</text>
    <rect x="10" y="96" width="380" height="24" rx="4" fill="#831843"/>
    <text x="20" y="113" font-size="12" fill="#f9a8d4">&#x1F517;  stage_id</text>     <text x="240" y="113" font-size="11" fill="#94a3b8">INTEGER  FK &rarr; stages</text>
    <line x1="10" y1="122" x2="390" y2="122" stroke="#334155"/>
    <text x="20" y="140" font-size="12" fill="#e2e8f0">title</text>             <text x="240" y="140" font-size="11" fill="#64748b">VARCHAR(255) NOT NULL</text>
    <text x="20" y="160" font-size="12" fill="#e2e8f0">description</text>        <text x="240" y="160" font-size="11" fill="#64748b">TEXT</text>
    <text x="20" y="180" font-size="12" fill="#e2e8f0">submission_url</text>     <text x="240" y="180" font-size="11" fill="#64748b">VARCHAR(500)</text>
    <text x="20" y="200" font-size="12" fill="#e2e8f0">github_repo</text>        <text x="240" y="200" font-size="11" fill="#64748b">VARCHAR(500)</text>
    <text x="20" y="220" font-size="12" fill="#e2e8f0">additional_notes</text>   <text x="240" y="220" font-size="11" fill="#64748b">TEXT</text>
    <text x="20" y="240" font-size="12" fill="#e2e8f0">status</text>             <text x="240" y="240" font-size="11" fill="#64748b">ENUM submission_status</text>
    <text x="20" y="260" font-size="12" fill="#e2e8f0">submitted_at</text>       <text x="240" y="260" font-size="11" fill="#64748b">TIMESTAMPTZ DEFAULT NOW()</text>
    <text x="20" y="280" font-size="12" fill="#e2e8f0">updated_at</text>         <text x="240" y="280" font-size="11" fill="#64748b">TIMESTAMPTZ  (auto-trigger)</text>
    <line x1="10" y1="290" x2="390" y2="290" stroke="#334155"/>
    <text x="20" y="308" font-size="11" fill="#ec4899" font-style="italic">UNIQUE: (participant_id, stage_id)</text>
  </g>

  <!-- TABLE: evaluations   x=1150 y=480  w=420 h=370 -->
  <g transform="translate(1150,480)">
    <rect width="420" height="370" rx="10" fill="#1e293b" stroke="#ec4899" stroke-width="2.5"/>
    <rect width="420" height="36" rx="10" fill="#be185d"/>
    <rect y="26" width="420" height="10" fill="#be185d"/>
    <text x="210" y="24" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">&#x1F3C6;  evaluations</text>
    <rect x="10" y="44" width="400" height="24" rx="4" fill="#500724"/>
    <text x="20" y="61" font-size="12" fill="#fbbf24">&#x1F511;  evaluation_id</text>  <text x="250" y="61" font-size="11" fill="#94a3b8">UUID  PRIMARY KEY</text>
    <rect x="10" y="70" width="400" height="24" rx="4" fill="#831843"/>
    <text x="20" y="87" font-size="12" fill="#f9a8d4">&#x1F517;  submission_id</text>  <text x="250" y="87" font-size="11" fill="#94a3b8">UUID  FK &rarr; submissions</text>
    <rect x="10" y="96" width="400" height="24" rx="4" fill="#831843"/>
    <text x="20" y="113" font-size="12" fill="#f9a8d4">&#x1F517;  judge_id</text>      <text x="250" y="113" font-size="11" fill="#94a3b8">UUID  FK &rarr; judges</text>
    <line x1="10" y1="122" x2="410" y2="122" stroke="#334155"/>
    <text x="20" y="140" font-size="12" fill="#e2e8f0">score</text>              <text x="250" y="140" font-size="11" fill="#64748b">NUMERIC(6,2)  CHECK 0–100</text>
    <text x="20" y="160" font-size="12" fill="#e2e8f0">technical_score</text>    <text x="250" y="160" font-size="11" fill="#64748b">NUMERIC(6,2)  CHECK 0–100</text>
    <text x="20" y="180" font-size="12" fill="#e2e8f0">creativity_score</text>   <text x="250" y="180" font-size="11" fill="#64748b">NUMERIC(6,2)  CHECK 0–100</text>
    <text x="20" y="200" font-size="12" fill="#e2e8f0">usability_score</text>    <text x="250" y="200" font-size="11" fill="#64748b">NUMERIC(6,2)  CHECK 0–100</text>
    <text x="20" y="220" font-size="12" fill="#e2e8f0">presentation_score</text> <text x="250" y="220" font-size="11" fill="#64748b">NUMERIC(6,2)  CHECK 0–100</text>
    <text x="20" y="240" font-size="12" fill="#e2e8f0">feedback</text>           <text x="250" y="240" font-size="11" fill="#64748b">TEXT</text>
    <text x="20" y="260" font-size="12" fill="#e2e8f0">is_final</text>           <text x="250" y="260" font-size="11" fill="#64748b">BOOLEAN DEFAULT FALSE</text>
    <text x="20" y="280" font-size="12" fill="#e2e8f0">evaluated_at</text>       <text x="250" y="280" font-size="11" fill="#64748b">TIMESTAMPTZ DEFAULT NOW()</text>
    <text x="20" y="300" font-size="12" fill="#e2e8f0">updated_at</text>         <text x="250" y="300" font-size="11" fill="#64748b">TIMESTAMPTZ  (auto-trigger)</text>
    <line x1="10" y1="310" x2="410" y2="310" stroke="#334155"/>
    <text x="20" y="328" font-size="11" fill="#ec4899" font-style="italic">UNIQUE: (submission_id, judge_id)</text>
    <text x="20" y="346" font-size="11" fill="#ec4899" font-style="italic">RLS: judges see only their own evaluations</text>
    <text x="20" y="362" font-size="11" fill="#ec4899" font-style="italic">Trigger: auto-updates submission status</text>
  </g>

  <!-- ══════════════════════════════════════════════════════════════ -->
  <!-- ROW 3 — TABLES                                                 -->
  <!-- ══════════════════════════════════════════════════════════════ -->

  <!-- TABLE: stage_progress   x=60 y=870  w=400 h=300 -->
  <g transform="translate(60,870)">
    <rect width="400" height="300" rx="10" fill="#1e293b" stroke="#f59e0b" stroke-width="2.5"/>
    <rect width="400" height="36" rx="10" fill="#d97706"/>
    <rect y="26" width="400" height="10" fill="#d97706"/>
    <text x="200" y="24" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">&#x1F4C8;  stage_progress</text>
    <rect x="10" y="44" width="380" height="24" rx="4" fill="#78350f"/>
    <text x="20" y="61" font-size="12" fill="#fbbf24">&#x1F511;  progress_id</text>   <text x="240" y="61" font-size="11" fill="#94a3b8">UUID  PRIMARY KEY</text>
    <rect x="10" y="70" width="380" height="24" rx="4" fill="#92400e"/>
    <text x="20" y="87" font-size="12" fill="#fde68a">&#x1F517;  participant_id</text> <text x="240" y="87" font-size="11" fill="#94a3b8">UUID  FK &rarr; participants</text>
    <rect x="10" y="96" width="380" height="24" rx="4" fill="#92400e"/>
    <text x="20" y="113" font-size="12" fill="#fde68a">&#x1F517;  stage_id</text>     <text x="240" y="113" font-size="11" fill="#94a3b8">INTEGER  FK &rarr; stages</text>
    <line x1="10" y1="122" x2="390" y2="122" stroke="#334155"/>
    <text x="20" y="140" font-size="12" fill="#e2e8f0">qualified</text>          <text x="240" y="140" font-size="11" fill="#64748b">BOOLEAN DEFAULT FALSE</text>
    <text x="20" y="160" font-size="12" fill="#e2e8f0">average_score</text>      <text x="240" y="160" font-size="11" fill="#64748b">NUMERIC(6,2)</text>
    <text x="20" y="180" font-size="12" fill="#e2e8f0">rank_in_stage</text>      <text x="240" y="180" font-size="11" fill="#64748b">INTEGER</text>
    <text x="20" y="200" font-size="12" fill="#e2e8f0">advanced_to_next</text>   <text x="240" y="200" font-size="11" fill="#64748b">BOOLEAN DEFAULT FALSE</text>
    <text x="20" y="220" font-size="12" fill="#e2e8f0">notes</text>              <text x="240" y="220" font-size="11" fill="#64748b">TEXT</text>
    <text x="20" y="240" font-size="12" fill="#e2e8f0">created_at</text>         <text x="240" y="240" font-size="11" fill="#64748b">TIMESTAMPTZ</text>
    <text x="20" y="260" font-size="12" fill="#e2e8f0">updated_at</text>         <text x="240" y="260" font-size="11" fill="#64748b">TIMESTAMPTZ  (auto-trigger)</text>
    <line x1="10" y1="270" x2="390" y2="270" stroke="#334155"/>
    <text x="20" y="288" font-size="11" fill="#f59e0b" font-style="italic">UNIQUE: (participant_id, stage_id)</text>
  </g>

  <!-- TABLE: audit_logs   x=600 y=870  w=420 h=320 -->
  <g transform="translate(600,870)">
    <rect width="420" height="320" rx="10" fill="#1e293b" stroke="#ef4444" stroke-width="2.5"/>
    <rect width="420" height="36" rx="10" fill="#dc2626"/>
    <rect y="26" width="420" height="10" fill="#dc2626"/>
    <text x="210" y="24" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">&#x1F4DD;  audit_logs</text>
    <rect x="10" y="44" width="400" height="24" rx="4" fill="#7f1d1d"/>
    <text x="20" y="61" font-size="12" fill="#fbbf24">&#x1F511;  log_id</text>         <text x="240" y="61" font-size="11" fill="#94a3b8">BIGSERIAL  PRIMARY KEY</text>
    <rect x="10" y="70" width="400" height="24" rx="4" fill="#991b1b"/>
    <text x="20" y="87" font-size="12" fill="#fca5a5">&#x1F517;  user_id</text>        <text x="240" y="87" font-size="11" fill="#94a3b8">UUID  FK &rarr; users (nullable)</text>
    <line x1="10" y1="96" x2="410" y2="96" stroke="#334155"/>
    <text x="20" y="114" font-size="12" fill="#e2e8f0">action</text>             <text x="240" y="114" font-size="11" fill="#64748b">ENUM audit_action</text>
    <text x="20" y="134" font-size="12" fill="#e2e8f0">table_name</text>          <text x="240" y="134" font-size="11" fill="#64748b">VARCHAR(100) NOT NULL</text>
    <text x="20" y="154" font-size="12" fill="#e2e8f0">record_id</text>           <text x="240" y="154" font-size="11" fill="#64748b">TEXT</text>
    <text x="20" y="174" font-size="12" fill="#e2e8f0">old_values</text>          <text x="240" y="174" font-size="11" fill="#64748b">JSONB  (before-state)</text>
    <text x="20" y="194" font-size="12" fill="#e2e8f0">new_values</text>          <text x="240" y="194" font-size="11" fill="#64748b">JSONB  (after-state)</text>
    <text x="20" y="214" font-size="12" fill="#e2e8f0">ip_address</text>          <text x="240" y="214" font-size="11" fill="#64748b">INET</text>
    <text x="20" y="234" font-size="12" fill="#e2e8f0">user_agent</text>          <text x="240" y="234" font-size="11" fill="#64748b">TEXT</text>
    <text x="20" y="254" font-size="12" fill="#e2e8f0">performed_at</text>        <text x="240" y="254" font-size="11" fill="#64748b">TIMESTAMPTZ DEFAULT NOW()</text>
    <line x1="10" y1="264" x2="410" y2="264" stroke="#334155"/>
    <text x="20" y="282" font-size="11" fill="#ef4444" font-style="italic">Auto-populated by triggers on submissions &amp; evaluations</text>
    <text x="20" y="300" font-size="11" fill="#ef4444" font-style="italic">Indexed on: user_id, table_name, performed_at DESC</text>
  </g>

  <!-- TABLE: notifications   x=1150 y=870  w=400 h=280 -->
  <g transform="translate(1150,870)">
    <rect width="400" height="280" rx="10" fill="#1e293b" stroke="#84cc16" stroke-width="2.5"/>
    <rect width="400" height="36" rx="10" fill="#65a30d"/>
    <rect y="26" width="400" height="10" fill="#65a30d"/>
    <text x="200" y="24" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">&#x1F514;  notifications</text>
    <rect x="10" y="44" width="380" height="24" rx="4" fill="#1a2e05"/>
    <text x="20" y="61" font-size="12" fill="#fbbf24">&#x1F511;  notification_id</text> <text x="240" y="61" font-size="11" fill="#94a3b8">UUID  PRIMARY KEY</text>
    <rect x="10" y="70" width="380" height="24" rx="4" fill="#365314"/>
    <text x="20" y="87" font-size="12" fill="#bef264">&#x1F517;  user_id</text>        <text x="240" y="87" font-size="11" fill="#94a3b8">UUID  FK &rarr; users</text>
    <line x1="10" y1="96" x2="390" y2="96" stroke="#334155"/>
    <text x="20" y="114" font-size="12" fill="#e2e8f0">title</text>              <text x="240" y="114" font-size="11" fill="#64748b">VARCHAR(255) NOT NULL</text>
    <text x="20" y="134" font-size="12" fill="#e2e8f0">message</text>            <text x="240" y="134" font-size="11" fill="#64748b">TEXT NOT NULL</text>
    <text x="20" y="154" font-size="12" fill="#e2e8f0">notification_type</text>  <text x="240" y="154" font-size="11" fill="#64748b">VARCHAR(50)</text>
    <text x="20" y="174" font-size="12" fill="#e2e8f0">is_read</text>            <text x="240" y="174" font-size="11" fill="#64748b">BOOLEAN DEFAULT FALSE</text>
    <text x="20" y="194" font-size="12" fill="#e2e8f0">related_id</text>         <text x="240" y="194" font-size="11" fill="#64748b">TEXT  (generic reference)</text>
    <text x="20" y="214" font-size="12" fill="#e2e8f0">created_at</text>         <text x="240" y="214" font-size="11" fill="#64748b">TIMESTAMPTZ DEFAULT NOW()</text>
    <line x1="10" y1="224" x2="390" y2="224" stroke="#334155"/>
    <text x="20" y="242" font-size="11" fill="#84cc16" font-style="italic">RLS: users see only their own rows</text>
    <text x="20" y="260" font-size="11" fill="#84cc16" font-style="italic">Auto-sent via register_participant() procedure</text>
  </g>

  <!-- ══════════════════════════════════════════════════════════════ -->
  <!-- LEGEND  x=1620 y=480                                          -->
  <!-- ══════════════════════════════════════════════════════════════ -->
  <g transform="translate(1620,480)">
    <rect width="460" height="680" rx="12" fill="#1e293b" stroke="#475569" stroke-width="2"/>
    <rect width="460" height="38" rx="12" fill="#334155"/>
    <rect y="26" width="460" height="12" fill="#334155"/>
    <text x="230" y="26" text-anchor="middle" font-size="14" font-weight="bold" fill="#f1f5f9">LEGEND &amp; DATABASE STATS</text>

    <rect x="15" y="52" width="14" height="14" rx="3" fill="#fbbf24"/>
    <text x="38" y="64" font-size="12" fill="#e2e8f0">Primary Key (PK) — UUID or SERIAL</text>
    <rect x="15" y="76" width="14" height="14" rx="3" fill="#6ee7b7"/>
    <text x="38" y="88" font-size="12" fill="#e2e8f0">Foreign Key (FK) — with ON DELETE rules</text>

    <line x1="15" y1="112" x2="70" y2="112" stroke="#3b82f6" stroke-width="2" stroke-dasharray="8,4"/>
    <text x="80" y="116" font-size="12" fill="#e2e8f0">One-to-One  (1 : 1)</text>
    <line x1="15" y1="134" x2="70" y2="134" stroke="#10b981" stroke-width="2.5"/>
    <text x="80" y="138" font-size="12" fill="#e2e8f0">One-to-Many  (1 : N)</text>
    <line x1="15" y1="156" x2="70" y2="156" stroke="#ef4444" stroke-width="1.5" stroke-dasharray="6,4"/>
    <text x="80" y="160" font-size="12" fill="#e2e8f0">Trigger-generated (auto)</text>

    <line x1="10" y1="174" x2="450" y2="174" stroke="#334155"/>

    <text x="15" y="196" font-size="13" font-weight="bold" fill="#94a3b8">DATABASE OBJECTS</text>
    <text x="15" y="218" font-size="12" fill="#e2e8f0">Tables</text>          <text x="220" y="218" font-size="12" fill="#38bdf8" font-weight="bold">10</text>
    <text x="15" y="238" font-size="12" fill="#e2e8f0">Custom ENUMs</text>     <text x="220" y="238" font-size="12" fill="#38bdf8" font-weight="bold">5</text>
    <text x="15" y="258" font-size="12" fill="#e2e8f0">Indexes</text>          <text x="220" y="258" font-size="12" fill="#38bdf8" font-weight="bold">12</text>
    <text x="15" y="278" font-size="12" fill="#e2e8f0">Triggers</text>         <text x="220" y="278" font-size="12" fill="#38bdf8" font-weight="bold">6</text>
    <text x="15" y="298" font-size="12" fill="#e2e8f0">Views</text>             <text x="220" y="298" font-size="12" fill="#38bdf8" font-weight="bold">8</text>
    <text x="15" y="318" font-size="12" fill="#e2e8f0">Stored Procedures</text> <text x="220" y="318" font-size="12" fill="#38bdf8" font-weight="bold">4</text>
    <text x="15" y="338" font-size="12" fill="#e2e8f0">DB Roles</text>          <text x="220" y="338" font-size="12" fill="#38bdf8" font-weight="bold">4</text>
    <text x="15" y="358" font-size="12" fill="#e2e8f0">RLS Policies</text>      <text x="220" y="358" font-size="12" fill="#38bdf8" font-weight="bold">4</text>

    <line x1="10" y1="372" x2="450" y2="372" stroke="#334155"/>

    <text x="15" y="392" font-size="13" font-weight="bold" fill="#94a3b8">CUSTOM ENUMs</text>
    <text x="15" y="412" font-size="11" fill="#fbbf24">user_role</text>
    <text x="120" y="412" font-size="11" fill="#64748b">admin | judge | participant | support</text>
    <text x="15" y="430" font-size="11" fill="#fbbf24">submission_status</text>
    <text x="155" y="430" font-size="11" fill="#64748b">pending | under_review | accepted | rejected | flagged</text>
    <text x="15" y="448" font-size="11" fill="#fbbf24">stage_status</text>
    <text x="120" y="448" font-size="11" fill="#64748b">upcoming | active | completed | cancelled</text>
    <text x="15" y="466" font-size="11" fill="#fbbf24">participant_status</text>
    <text x="155" y="466" font-size="11" fill="#64748b">registered | active | disqualified | withdrawn | completed</text>
    <text x="15" y="484" font-size="11" fill="#fbbf24">audit_action</text>
    <text x="120" y="484" font-size="11" fill="#64748b">INSERT | UPDATE | DELETE | LOGIN | LOGOUT | VIEW</text>

    <line x1="10" y1="498" x2="450" y2="498" stroke="#334155"/>

    <text x="15" y="518" font-size="13" font-weight="bold" fill="#94a3b8">SEED DATA</text>
    <text x="15" y="538" font-size="11" fill="#e2e8f0">Users (total)</text>     <text x="220" y="538" font-size="11" fill="#4ade80">107</text>
    <text x="15" y="556" font-size="11" fill="#e2e8f0">Participants</text>      <text x="220" y="556" font-size="11" fill="#4ade80">100</text>
    <text x="15" y="574" font-size="11" fill="#e2e8f0">Judges</text>            <text x="220" y="574" font-size="11" fill="#4ade80">5</text>
    <text x="15" y="592" font-size="11" fill="#e2e8f0">Stages</text>            <text x="220" y="592" font-size="11" fill="#4ade80">4</text>
    <text x="15" y="610" font-size="11" fill="#e2e8f0">Submissions</text>       <text x="220" y="610" font-size="11" fill="#4ade80">60+</text>
    <text x="15" y="628" font-size="11" fill="#e2e8f0">Evaluations</text>       <text x="220" y="628" font-size="11" fill="#4ade80">25+</text>
    <text x="15" y="646" font-size="11" fill="#e2e8f0">Reports</text>           <text x="220" y="646" font-size="11" fill="#4ade80">5</text>
    <text x="15" y="664" font-size="11" fill="#e2e8f0">Notifications</text>     <text x="220" y="664" font-size="11" fill="#4ade80">20</text>

    <line x1="10" y1="674" x2="450" y2="674" stroke="#334155"/>
    <text x="230" y="694" text-anchor="middle" font-size="11" fill="#475569">Integrity &gt; Everything  |  Quality &gt; Size</text>
  </g>

</svg>
